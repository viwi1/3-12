<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3:12 Utdelningskalkylator</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; }
        .slider-container { display: flex; align-items: center; margin-bottom: 10px; }
        .slider-value { width: 60px; margin-left: 10px; font-weight: bold; }
        .box { border: 1px solid #ccc; padding: 15px; margin-top: 10px; background: #f9f9f9; }
        .result-title { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
        .result-value { font-size: 16px; font-weight: bold; color: #ff7bff; }
        .checkbox-container { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>

    <h2>3:12 Utdelningskalkylator</h2>

    <p><strong>Startvärde på aktierna:</strong> <span id="nuvarde"></span></p>

    <div class="checkbox-container">
        <input type="checkbox" id="daligtNuvarde" onchange="uppdateraNuvarde()">
        <label for="daligtNuvarde">Dåligt värde (3 000 000 kr)</label>
    </div>

    <div class="slider-container">
        <label for="multipel">Multipel:</label>
        <input type="range" id="multipel" min="1.1" max="4" step="0.1" value="1.5" oninput="uppdateraBeräkningar()">
        <span class="slider-value" id="multipelValue">1.5</span>
    </div>

    <div class="slider-container">
        <label for="avkastning">Avkastning (% per år):</label>
        <input type="range" id="avkastning" min="1" max="30" step="1" value="10" oninput="uppdateraBeräkningar()">
        <span class="slider-value" id="avkastningValue">10%</span>
    </div>

    <div class="result" id="resultAktieutdelning"></div>
    <div class="result" id="resultFörsäljning"></div>

    <h3>Historisk avkastning</h3>
    <table>
        <tr><th>År</th><th>Avkastning</th></tr>
        <tr><td>2021</td><td>+27,04%</td></tr>
        <tr><td>2022</td><td>-27,91%</td></tr>
        <tr><td>2023</td><td>+34,07%</td></tr>
        <tr><td>2024</td><td>+26,42%</td></tr>
    </table>

    <script>
        let normaltNuvarde = 6855837;
        let daligtNuvarde = 3000000;
        let nuvarde = normaltNuvarde;

        function formatNumber(num) {
            return num.toLocaleString("sv-SE") + " kr";
        }

        function uppdateraNuvarde() {
            let checkbox = document.getElementById("daligtNuvarde");
            nuvarde = checkbox.checked ? daligtNuvarde : normaltNuvarde;
            document.getElementById("nuvarde").textContent = formatNumber(nuvarde);
            uppdateraBeräkningar();
        }

        function uppdateraBeräkningar() {
            let multipel = parseFloat(document.getElementById("multipel").value);
            let avkastning = parseFloat(document.getElementById("avkastning").value) / 100;

            document.getElementById("multipelValue").textContent = multipel.toFixed(1);
            document.getElementById("avkastningValue").textContent = (avkastning * 100).toFixed(0) + "%";

            let försäljningspris = nuvarde * multipel;
            let totalAvkastning = försäljningspris * avkastning;

            let gränsbelopp = 209550;
            let skattLåg = 0.20;
            let skattHög = 0.50;

            let bruttoLåg = Math.min(totalAvkastning, gränsbelopp);
            let bruttoHög = totalAvkastning > gränsbelopp ? totalAvkastning - gränsbelopp : 0;

            let nettoLåg = bruttoLåg * (1 - skattLåg);
            let nettoHög = bruttoHög * (1 - skattHög);
            let totalNetto = nettoLåg + nettoHög;

            document.getElementById("resultAktieutdelning").innerHTML = `
                <div class="box">
                    <p class="result-title">Aktieutdelning</p>
                    <table>
                        <tr><th>Typ</th><th>Brutto</th><th>Netto</th></tr>
                        <tr><td>Inom gränsbelopp (20% skatt)</td><td>${formatNumber(bruttoLåg)}</td><td>${formatNumber(nettoLåg)}</td></tr>
                        <tr><td>Över gränsbelopp (50% skatt)</td><td>${formatNumber(bruttoHög)}</td><td>${formatNumber(nettoHög)}</td></tr>
                        <tr><td><strong>Totalt</strong></td><td><strong>${formatNumber(totalAvkastning)}</strong></td><td><strong>${formatNumber(totalNetto)}</strong></td></tr>
                    </table>
                </div>
            `;
        }

        window.onload = function() {
            uppdateraNuvarde();
        };
    </script>

</body>
</html>
