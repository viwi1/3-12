<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3:12 Utdelningskalkylator</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; }
        input, button { width: 100%; padding: 10px; margin: 10px 0; font-size: 16px; }
        .slider-container { display: flex; align-items: center; margin-bottom: 10px; }
        .slider-value { width: 60px; margin-left: 10px; font-weight: bold; }
        .box { border: 1px solid #ccc; padding: 15px; margin-top: 10px; background: #f9f9f9; }
        .result-title { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
        .result-value { font-size: 16px; font-weight: bold; color: #007bff; }

        /* Helt ny styling för checkbox */
        .checkbox-container {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 10px;
            margin-bottom: 10px;
        }
        .checkbox-container input {
            width: 20px;
            height: 20px;
            margin: 0;
        }
        .checkbox-container label {
            font-size: 16px;
            cursor: pointer;
            user-select: none;
        }
    </style>
</head>
<body>

    <h2>3:12 Utdelningskalkylator</h2>

    <h3>1️⃣ Kapital efter försäljning och utdelning per år</h3>
    
    <label>Nuvarande värde på bolaget:</label>
    <input type="text" id="nuvarde" readonly>

    <!-- FIXAD CHECKBOX SEKTOR -->
    <div class="checkbox-container">
        <input type="checkbox" id="daligtNuvarde" onchange="uppdateraNuvarde()">
        <label for="daligtNuvarde">Dåligt nuvärde (3 000 000 kr)</label>
    </div>

    <div class="slider-container">
        <label for="multipel">Multipel:</label>
        <input type="range" id="multipel" min="1.1" max="4" step="0.1" value="1.5" oninput="uppdateraBeräkningar()">
        <span class="slider-value" id="multipelValue">1.5</span>
    </div>

    <div class="slider-container">
        <label for="avkastning">Avkastning (% per år):</label>
        <input type="range" id="avkastning" min="1" max="30" step="1" value="10" oninput="uppdateraBeräkningar()">
        <span class="slider-value" id="avkastningValue">10%</span>
    </div>

    <div class="result" id="resultNettoMultipel"></div>
    <div class="result" id="resultFörsäljning"></div>

    <script>
        let normaltNuvarde = 6855837;
        let daligtNuvarde = 3000000;
        let nuvarde = normaltNuvarde;

        function formatNumber(num) {
            return num.toLocaleString("sv-SE") + " kr";
        }

        function uppdateraNuvarde() {
            let checkbox = document.getElementById("daligtNuvarde");
            nuvarde = checkbox.checked ? daligtNuvarde : normaltNuvarde;
            document.getElementById("nuvarde").value = formatNumber(nuvarde);
            uppdateraBeräkningar();
        }

        function uppdateraBeräkningar() {
            let multipel = parseFloat(document.getElementById("multipel").value);
            let avkastning = parseFloat(document.getElementById("avkastning").value) / 100;

            document.getElementById("multipelValue").textContent = multipel.toFixed(1);
            document.getElementById("avkastningValue").textContent = (avkastning * 100).toFixed(0) + "%";
            document.getElementById("nuvarde").value = formatNumber(nuvarde);

            let försäljningspris = nuvarde * multipel;
            let totalAvkastning = försäljningspris * avkastning;

            let gränsbelopp = 209550;
            let skattLåg = 0.20;
            let skattHög = 0.50;

            let bruttoLåg = Math.min(totalAvkastning, gränsbelopp);
            let bruttoHög = totalAvkastning > gränsbelopp ? totalAvkastning - gränsbelopp : 0;

            let nettoLåg = bruttoLåg * (1 - skattLåg);
            let nettoHög = bruttoHög * (1 - skattHög);
            let totalNetto = nettoLåg + nettoHög;

            document.getElementById("resultNettoMultipel").innerHTML = `
                <div class="box">
                    <p class="result-title">Totalt netto per år</p>
                    <p><strong>Netto utdelning per år:</strong> <span class="result-value">${formatNumber(totalNetto)}</span></p>
                </div>
            `;

            document.getElementById("resultFörsäljning").innerHTML = `
                <div class="box">
                    <p class="result-title">Kapital efter försäljning</p>
                    <p><strong>Nuvarande värde:</strong> <span class="result-value">${formatNumber(nuvarde)}</span></p>
                    <p><strong>Multipel:</strong> <span class="result-value">${multipel.toFixed(1)}</span></p>
                    <p><strong>Försäljningsvärde:</strong> <span class="result-value">${formatNumber(försäljningspris)}</span></p>
                </div>
            `;
        }

        window.onload = function() {
            uppdateraNuvarde();
            uppdateraBeräkningar();
        };
    </script>

</body>
</html>
